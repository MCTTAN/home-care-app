

<!DOCTYPE html>
<html lang="en">

<head>
  
  <!-- Title Page -->
  <title>Home</title>

  <!-- Browser Tab Icon -->
  <link href="media/logo-house.png" rel="icon">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;515;600;700&display=swap" rel="stylesheet">

  <!-- Font Face CSS -->
  <link href="assets/css/font-face.css" rel="stylesheet" media="all">
  <link href="assets/vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/font-awesome-5/css/fontawesome-all.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">

  <!-- Bootstrap CSS -->
  <link href="assets/vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

  <!-- Vendor CSS -->
  <link href="assets/vendor/animsition/animsition.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/bootstrap-progressbar/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/wow/animate.css" rel="stylesheet" media="all">
  <link href="assets/vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/slick/slick.css" rel="stylesheet" media="all">
  <link href="assets/vendor/select2/select2.min.css" rel="stylesheet" media="all">
  <link href="assets/vendor/perfect-scrollbar/perfect-scrollbar.css" rel="stylesheet" media="all">

  <!-- Main CSS -->
  <link href="assets/css/bootstrap-datetimepicker.min.css" media="all">
  <link href="assets/css/checkboxes.css" rel="stylesheet" media="all">
  <link href="assets/css/font-face.css" rel="stylesheet" media="all">
  <link href="assets/css/paddings.css" rel="stylesheet" media="all">
  <link href="assets/css/palette.css" rel="stylesheet" media="all">
  <link href="assets/css/progress-bars.css" rel="stylesheet" media="all">
  <link href="assets/css/search.css" rel="stylesheet" media="all">
  <link href="assets/css/slideshows.css" rel="stylesheet" media="all">
  <link href="assets/css/switches.css" rel="stylesheet" media="all">
  <link href="assets/css/theme.css" rel="stylesheet" media="all">
  <link href="assets/css/titles.css" rel="stylesheet" media="all">
  <link href="assets/css/upload.css" rel="stylesheet" media="all">

  <!-- Required Meta Tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Chantal">
  
  <style>
    iframe {
      width: 100%;
      border: 0;
      min-height: 80%;
      height: 600px;
      display: flex;
    }
  </style>

</head>

<body class="animsition">
  <div class="page-wrapper">

    <!-- START - MOBILE - HEADER MENU/NAVIGATION -->
    <header class="header-mobile dblock d-lg-none">

      <div class="header-mobile__bar">
        <div class="container-fluid">
          <div class="header-mobile-inner">

            <!-- LOGO -->
            <a class="logo" href="index.html">
              <img src="media/logo-name-house-inverse.png" style="max-width: 75%; max-height: 75%;" alt="Today's Home Care Logo" />
            </a>

            <!-- HAMBURGER BUTTON -->
            <button class="hamburger hamburger--slider" type="button">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
          </div>
        </div>
      </div>

      <!-- HAMBURGER MENU/NAVIGATION -->
      <nav class="navbar-mobile">
        <div class="container-fluid">
          <ul class="navbar-mobile__list list-unstyled">
            <li>
              <a href="index.html">Home</a>
            </li>
            <li>
              <a href="documents.html">Documents</a>
            </li>
            <li>
              <a href="clients.html">Clients</a>
            </li>
            <li>
              <a href="caregivers.html">Caregivers</a>
            </li>
            <li class="active has-sub">
              <a href="email.html">Email</a>
            </li>
            <li>
              <a href="calendar.html">Calendar</a>
            </li>
            <li>
              <a href="settings.html">Settings</a>
            </li>
            <li>
              <a href="help.html">Help</a>
            </li>
          </ul>
        </div>
      </nav>

    </header>
    <!-- END - MOBILE - HEADER MENU/NAVIGATION -->

    <!-- START - DESKTOP - SIDEBAR MENU/NAVIGATION -->
    <aside class="menu-sidebar d-none d-lg-block">

      <!-- LOGO -->
      <div class="logo" style="padding: 40px;">
        <a href="index.html">
          <img src="media/logo-name-house-inverse.png" style="max-width: 90%; max-height: 90%;" alt="Today's Home Care Logo" />
        </a>
      </div>

      <!-- SIDEBAR MENU/NAVIGATION -->
      <div class="menu-sidebar__content js-scrollbar1">
        <nav class="navbar-sidebar">
          <ul class="list-unstyled navbar__list">
            <li>
              <a href="index.html">Home</a>
            </li>
            <li>
              <a href="documents.html">Documents</a>
            </li>
            <li>
              <a href="clients.html">Clients</a>
            </li>
            <li>
              <a href="caregivers.html">Caregivers</a>
            </li>
            <li class="active has-sub">
              <a href="email.html">Email</a>
            </li>
            <li>
              <a href="calendar.html">Calendar</a>
            </li>
            <li>
              <a href="settings.html">Settings</a>
            </li>
            <li>
              <a href="help.html">Help</a>
            </li>
          </ul>
        </nav>
      </div>

    </aside>
    <!-- END - DESKTOP - SIDEBAR MENU/NAVIGATION -->

    <!-- START - MAIN PAGE -->
    <div class="page-container">

      <!-- START - DESKTOP - HEADER -->
      <header class="header-desktop">
        <div class="section__content section__content--p30">
          <div class="container-fluid">
            <div class="header-wrap">

              <!-- SEARCH BAR -->
              <form class="form-header" action="" method="POST">
                <input class="au-input au-input--xl" type="text" name="search" placeholder="Search">
                <button class="au-btn--submit default-color" type="submit">
                  <i class="zmdi zmdi-search"></i>
                </button>
              </form>

              <!-- START - HEADER - ELEMENTS TO THE RIGHT -->
              <div class="header-button">

                <!-- START - NOTIFICATIONS -->
                <div class="noti-wrap">

                  <!-- START - MESSAGE NOTIFICATIONS -->
                  <div class="noti__item js-item-menu">
                    <i class="zmdi zmdi-email"></i>
                    
                    <div class="email-dropdown js-dropdown">

                      <div class="email__title">
                        <p>You have no new messages.</p>
                      </div>

                      <div class="email__item">
                        <div class="image img-cir img-40">
                          <img src="" alt="">
                        </div>
                        <div class="content">
                          <p>Item 1</p>
                          <span>Posted by ___, 3 min ago</span>
                        </div>
                      </div>

                      <div class="email__item">
                        <div class="image img-cir img-40">
                          <img src="" alt="">
                        </div>
                        <div class="content">
                          <p>Item 2</p>
                          <span>Posted by ___, 10 min ago</span>
                        </div>
                      </div>

                      <div class="email__item">
                        <div class="image img-cir img-40">
                          <img src="" alt="">
                        </div>
                        <div class="content">
                          <p>Item 3</p>
                          <span>Posted by ___, 40 min ago</span>
                        </div>
                      </div>

                      <div class="email__footer">
                        <a href="messages.html">See all messages</a>
                      </div>

                    </div>
                  </div>
                  <!-- END - MESSAGE NOTIFICATIONS -->

                  <!-- START - BELL NOTIFICATIONS -->
                  <div class="noti__item js-item-menu">
                    <i class="zmdi zmdi-notifications"></i>
                    
                    <div class="notifi-dropdown js-dropdown">

                      <div class="notifi__title">
                        <p>You have no notifications.</p>
                      </div>

                      <div class="notifi__item">
                        <div class="bg-c1 img-cir img-40">
                          <i class="zmdi zmdi-email-open"></i>
                        </div>
                        <div class="content">
                          <p>You received an email.</p>
                          <span class="date">April 12, 2018 06:50 PM</span>
                        </div>
                      </div>

                      <div class="notifi__item">
                        <div class="bg-c1 img-cir img-40">
                          <i class="zmdi zmdi-email-open"></i>
                        </div>
                        <div class="content">
                          <p>You received an email.</p>
                          <span class="date">April 10, 2018 06:50 PM</span>
                        </div>
                      </div>

                      <div class="notifi__item">
                        <div class="bg-c1 img-cir img-40">
                          <i class="zmdi zmdi-email-open"></i>
                        </div>
                        <div class="content">
                          <p>You received an email.</p>
                          <span class="date">April 9, 2018 06:50 PM</span>
                        </div>
                      </div>

                      <div class="notifi__footer">
                        <a href="notifications.html">See all notifications</a>
                      </div>

                    </div>
                  </div>
                  <!-- END - BELL NOTIFICATIONS -->

                </div>
                <!-- END - NOTIFICATIONS -->

              </div>
              <!-- END - HEADER - ELEMENTS TO THE RIGHT -->

            </div>
          </div>
        </div>
      </header>
      <!-- END - DESKTOP - HEADER -->

      <!-- START - MAIN CONTENT -->
      <div class="main-content">
        <div class="section__content section__content--p30">
          <div class="container-fluid">
            
            <a href="#compose-modal" data-toggle="modal" id="compose-button" class="btn pull-right hidden">Compose</a>
            
            <br>

            <button id="authorize-button" class="btn hidden">Authorize</button>
            
            <br>
      
            <table class="table table-striped table-inbox hidden">
              <thead>
                <tr>
                  <th>From</th>
                  <th>Subject</th>
                  <th>Date/Time</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
      
          <div class="modal fade" id="compose-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title">Compose</h4>
                </div>
                <form onsubmit="return sendEmail();">
                  <div class="modal-body">
                    <div class="form-group">
                      <input type="email" class="form-control" id="compose-to" placeholder="To" required />
                    </div>
      
                    <div class="form-group">
                      <input type="text" class="form-control" id="compose-subject" placeholder="Subject" required />
                    </div>
      
                    <div class="form-group">
                      <textarea class="form-control" id="compose-message" placeholder="Message" rows="10" required></textarea>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" id="send-button" class="btn btn-primary">Send</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
      
          <div class="modal fade" id="reply-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title">Reply</h4>
                </div>
                <form onsubmit="return sendReply();">
                  <input type="hidden" id="reply-message-id" />
      
                  <div class="modal-body">
                    <div class="form-group">
                      <input type="text" class="form-control" id="reply-to" disabled />
                    </div>
      
                    <div class="form-group">
                      <input type="text" class="form-control disabled" id="reply-subject" disabled />
                    </div>
      
                    <div class="form-group">
                      <textarea class="form-control" id="reply-message" placeholder="Message" rows="10" required></textarea>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" id="reply-button" class="btn btn-primary">Send</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
      
          <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
          <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
      
          <script type="text/javascript">
            var clientId = '422619975258-036umikhojfo1i8tq6cp1ejcltoh6lns.apps.googleusercontent.com';
            var apiKey = 'AIzaSyAHkFjZk2JFtXVIOGZIXXx5noPz1XQaNbo';
            var scopes =
              //'https://www.googleapis.com/auth/gmail.readonly '+
              'https://www.googleapis.com/auth/gmail.labels ' +
              'https://www.googleapis.com/auth/gmail.send ' +
              'https://www.googleapis.com/auth/gmail.compose ' +
              'https://www.googleapis.com/auth/gmail.insert ' +
              'https://www.googleapis.com/auth/gmail.modify ' +
              'https://www.googleapis.com/auth/gmail.metadata ' +
              'https://www.googleapis.com/auth/gmail.settings.basic ' +
              'https://www.googleapis.com/auth/gmail.settings.sharing ' +
              'https://mail.google.com';
      
            function deleteMessage(userId, messageId) {
              var request = gapi.client.gmail.users.messages.delete({
                'userId': userId,
                'id': messageId
              });
              request.execute(
                function(resp) { });
            }
            
            function handleClientLoad() {
              gapi.client.setApiKey(apiKey);
              window.setTimeout(checkAuth, 1);
            }
      
            function checkAuth() {
              gapi.auth.authorize({
                client_id: clientId,
                scope: scopes,
                immediate: true
              }, handleAuthResult);
            }
      
            function handleAuthClick() {
              gapi.auth.authorize({
                client_id: clientId,
                scope: scopes,
                immediate: false
              }, handleAuthResult);
              return false;
            }
      
            function handleAuthResult(authResult) {
              if(authResult && !authResult.error) {
                loadGmailApi();
                $('#authorize-button').remove();
                $('.table-inbox').removeClass("hidden");
                $('#compose-button').removeClass("hidden");
              } else {
                $('#authorize-button').removeClass("hidden");
                $('#authorize-button').on('click', function(){
                  handleAuthClick();
                });
              }
            }
      
            function loadGmailApi() {
              gapi.client.load('gmail', 'v1', displayInbox);
            }
      
            function displayInbox() {
              var request = gapi.client.gmail.users.messages.list({
                'userId': 'me',
                'labelIds': 'INBOX',
                'maxResults': 9999
              });
              request.execute(function(response) {
                $.each(response.messages, function() {
                  var messageRequest = gapi.client.gmail.users.messages.get({
                    'userId': 'me',
                    'id': this.id
                  });
                  messageRequest.execute(appendMessageRow);
                });
              });
            }
      
            function appendMessageRow(message) {
              $('.table-inbox tbody').append(
                '<tr>\
                  <td>'+getHeader(message.payload.headers, 'From')+'</td>\
                  <td>\
                    <a href="#message-modal-' + message.id +
                      '" data-toggle="modal" id="message-link-' + message.id+'">' +
                      getHeader(message.payload.headers, 'Subject') +
                    '</a>\
                  </td>\
                  <td>'+getHeader(message.payload.headers, 'Date')+'</td>\
                </tr>'
              );
              var reply_to = (getHeader(message.payload.headers, 'Reply-to') !== '' ?
                getHeader(message.payload.headers, 'Reply-to') :
                getHeader(message.payload.headers, 'From')).replace(/\"/g, '&quot;');
      
              var reply_subject = 'Re: '+getHeader(message.payload.headers, 'Subject').replace(/\"/g, '&quot;');
              $('body').append(
                '<div class="modal fade" id="message-modal-' + message.id +
                    '" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\
                  <div class="modal-dialog modal-lg">\
                    <div class="modal-content">\
                      <div class="modal-header">\
                        <button type="button"\
                                class="close"\
                                data-dismiss="modal"\
                                aria-label="Close">\
                          <span aria-hidden="true">&times;</span></button>\
                        <h4 class="modal-title" id="myModalLabel">' +
                          getHeader(message.payload.headers, 'Subject') +
                        '</h4>\
                      </div>\
                      <div class="modal-body">\
                        <iframe id="message-iframe-'+message.id+'" srcdoc="<p>Loading...</p>">\
                        </iframe>\
                      </div>\
                      <div class="modal-footer">\
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\
                        <button type="button" class="btn btn-primary reply-button" data-dismiss="modal" data-toggle="modal" data-target="#reply-modal"\
                        onclick="fillInReply(\
                          \''+reply_to+'\', \
                          \''+reply_subject+'\', \
                          \''+getHeader(message.payload.headers, 'Message-ID')+'\'\
                          );"\
                        >Reply</button>\
                      </div>\
                    </div>\
                  </div>\
                </div>'
              );
              $('#message-link-'+message.id).on('click', function(){
                var ifrm = $('#message-iframe-'+message.id)[0].contentWindow.document;
                $('body', ifrm).html(getBody(message.payload));
              });
            }
      
            function sendEmail()
            {
              $('#send-button').addClass('disabled');
      
              sendMessage(
                {
                  'To': $('#compose-to').val(),
                  'Subject': $('#compose-subject').val()
                },
                $('#compose-message').val(),
                composeTidy
              );
      
              return false;
            }
      
            function composeTidy()
            {
              $('#compose-modal').modal('hide');
      
              $('#compose-to').val('');
              $('#compose-subject').val('');
              $('#compose-message').val('');
      
              $('#send-button').removeClass('disabled');
            }
      
            function sendReply()
            {
              $('#reply-button').addClass('disabled');
      
              sendMessage(
                {
                  'To': $('#reply-to').val(),
                  'Subject': $('#reply-subject').val(),
                  'In-Reply-To': $('#reply-message-id').val()
                },
                $('#reply-message').val(),
                replyTidy
              );
      
              return false;
            }
      
            function replyTidy()
            {
              $('#reply-modal').modal('hide');
      
              $('#reply-message').val('');
      
              $('#reply-button').removeClass('disabled');
            }
      
            function fillInReply(to, subject, message_id)
            {
              $('#reply-to').val(to);
              $('#reply-subject').val(subject);
              $('#reply-message-id').val(message_id);
            }
      
            function sendMessage(headers_obj, message, callback)
            {
              var email = '';
      
              for(var header in headers_obj)
                email += header += ": "+headers_obj[header]+"\r\n";
      
              email += "\r\n" + message;
      
              var sendRequest = gapi.client.gmail.users.messages.send({
                'userId': 'me',
                'resource': {
                  'raw': window.btoa(email).replace(/\+/g, '-').replace(/\//g, '_')
                }
              });
      
              return sendRequest.execute(callback);
            }
      
            function getHeader(headers, index) {
              var header = '';
              $.each(headers, function(){
                if(this.name.toLowerCase() === index.toLowerCase()){
                  header = this.value;
                }
              });
              return header;
            }
      
            function getBody(message) {
              var encodedBody = '';
              if(typeof message.parts === 'undefined')
              {
                encodedBody = message.body.data;
              }
              else
              {
                encodedBody = getHTMLPart(message.parts);
              }
              encodedBody = encodedBody.replace(/-/g, '+').replace(/_/g, '/').replace(/\s/g, '');
              return decodeURIComponent(escape(window.atob(encodedBody)));
            }
      
            function getHTMLPart(arr) {
              for(var x = 0; x <= arr.length; x++)
              {
                if(typeof arr[x].parts === 'undefined')
                {
                  if(arr[x].mimeType === 'text/html')
                  {
                    return arr[x].body.data;
                  }
                }
                else
                {
                  return getHTMLPart(arr[x].parts);
                }
              }
              return '';
            }
          </script>
          <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
            
          </div>
        </div>
      </div>

    </div>
    <!-- END - MAIN PAGE -->

    <!-- Jquery JS -->
    <script src="assets/vendor/jquery-3.2.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="assets/vendor/bootstrap-4.1/popper.min.js"></script>
    <script src="assets/vendor/bootstrap-4.1/bootstrap.min.js"></script>

    <!-- Vendor JS -->
    <script src="assets/vendor/slick/slick.min.js"></script>
    <script src="assets/vendor/wow/wow.min.js"></script>
    <script src="assets/vendor/animsition/animsition.min.js"></script>
    <script src="assets/vendor/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <script src="assets/vendor/counter-up/jquery.waypoints.min.js"></script>
    <script src="assets/vendor/counter-up/jquery.counterup.min.js"></script>
    <script src="assets/vendor/circle-progress/circle-progress.min.js"></script>
    <script src="assets/vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="assets/vendor/chartjs/Chart.bundle.min.js"></script>
    <script src="assets/vendor/select2/select2.min.js"></script>

    <!-- Main JS-->
    <script src="assets/js/index.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/moment.js"></script>
    <script src="assets/js/upload.js"></script>

</body>

</html>
